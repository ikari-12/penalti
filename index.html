<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Pênalti 2D Realista</title>
<style>
body{
    margin:0;
    background:#1a1a1a;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}
canvas{
    background:linear-gradient(#4CAF50,#2e8b57);
    border:4px solid white;
}
</style>
</head>
<body>

<canvas id="game" width="800" height="500"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

// ==================== FÍSICA ====================
const GRAVITY = 0.25;

class Ball {
    constructor(){
        this.reset();
    }

    reset(){
        this.x = 400;
        this.y = 420;
        this.radius = 10;
        this.vx = 0;
        this.vy = 0;
        this.active = false;
    }

    shoot(targetX,targetY){
        let dx = targetX - this.x;
        let dy = targetY - this.y;

        let power = 0.15;

        this.vx = dx * power;
        this.vy = dy * power;
        this.active = true;
    }

    update(){
        if(!this.active) return;

        this.vy += GRAVITY;
        this.x += this.vx;
        this.y += this.vy;
    }

    draw(){
        ctx.beginPath();
        ctx.fillStyle="white";
        ctx.arc(this.x,this.y,this.radius,0,Math.PI*2);
        ctx.fill();
    }
}

class Goalkeeper{
    constructor(){
        this.baseX = 350;
        this.x = 350;
        this.y = 80;
        this.width = 100;
        this.height = 20;
        this.jumping = false;
        this.jumpTime = 0;
        this.direction = 0;
    }

    react(ballX){
        this.direction = ballX < 400 ? -1 : 1;
        this.jumping = true;
        this.jumpTime = 0;
    }

    update(){
        if(this.jumping){
            this.jumpTime += 0.05;

            this.x = this.baseX + this.direction * 150 * this.jumpTime;
            this.y = 80 - Math.sin(this.jumpTime*Math.PI)*80;

            if(this.jumpTime>=1){
                this.jumping=false;
                this.x=this.baseX;
                this.y=80;
            }
        }
    }

    draw(){
        ctx.fillStyle="blue";
        ctx.fillRect(this.x,this.y,this.width,this.height);
    }
}

const ball = new Ball();
const keeper = new Goalkeeper();

let goals = 0;
let attempts = 0;

// ==================== CONTROLE ====================
canvas.addEventListener("mousedown",(e)=>{
    if(ball.active) return;

    const rect = canvas.getBoundingClientRect();
    const tx = e.clientX - rect.left;
    const ty = e.clientY - rect.top;

    ball.shoot(tx,ty);
    keeper.react(tx);
});

// ==================== GAME LOOP ====================
function update(){
    ball.update();
    keeper.update();

    if(ball.active){
        // Defesa
        if(
            ball.y - ball.radius <= keeper.y + keeper.height &&
            ball.x >= keeper.x &&
            ball.x <= keeper.x + keeper.width
        ){
            attempts++;
            alert("DEFENDEU!");
            ball.reset();
        }

        // Gol
        if(ball.y <= 50){
            goals++;
            attempts++;
            alert("GOOOL!");
            ball.reset();
        }
    }
}

function drawField(){
    ctx.clearRect(0,0,800,500);

    ctx.strokeStyle="white";
    ctx.lineWidth=4;
    ctx.strokeRect(250,50,300,100);

    ctx.fillStyle="white";
    ctx.font="18px Arial";
    ctx.fillText("Gols: "+goals,20,30);
    ctx.fillText("Tentativas: "+attempts,20,55);
}

function gameLoop(){
    drawField();
    ball.draw();
    keeper.draw();
    update();
    requestAnimationFrame(gameLoop);
}

gameLoop();
</script>

</body>
</html>
